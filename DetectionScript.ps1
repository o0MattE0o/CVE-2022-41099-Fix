$WINREA = reagentc /info | findstr "\\?\GLOBALROOT\device"
$WINREB = $WINREA.replace("Windows RE location: ","").TRIM()
$WINREC = $WINREB + "\winre.wim"
$WINRED = $WINREC + " /index:1"
$WINREE = "Dism /Get-ImageInfo /ImageFile:$WINRED"
$WINREF = Invoke-Expression $WINREE

If ($WINREF -contains "ServicePack Build : 2486") {
    Write-Host "up-to-date"
    exit 0
} Else {
    Write-Error "not up-to-date"
    exit 1
}
